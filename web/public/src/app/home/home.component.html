<h1>Réseau Groupomania</h1>
<div class="home">
  <form *ngIf="connected" (ngSubmit)="onSubmitPublication(f)" #f="ngForm">
    <h3>Publier sur le réseau Groupomania</h3>
    <label for="content">Ecrivez quelque chose, lien d'article ou vidéo YouTube</label>
    <textarea name="content" id="content" ngModel></textarea>
    <label for="image" class="label-image">Ajouter une image</label>
    <input type="file" name="image" id="image" accept="image/*" (change)="onFileAdded($event)"/>
    <button>Publier</button>
  </form>
  <div *ngFor="let publication of publications">
    <div class="publication">
      <div class="header-publication">
        <div class="author">
          <div [style.background-image]="'url(' + getUrlPicture(publication.Profile.picture) + ')'" class="profile-picture"></div>
          <b>{{publication.Profile.lastName}} {{publication.Profile.firstName}}</b> posté <b>{{publication.createdAt | dateInterval}}</b>
        </div>
        <span *ngIf="auth.getAdmin() || auth.getId() === publication.UserId" (click)="onDeletePublication(publication.id)" class="delete">Supprimer</span>
      </div>
      <div class="content">{{publication.content}}</div>
      <div class="illustration" *ngIf="publication.picture">
        <img src="{{ getUrlPicture(publication.picture) }}" alt="publication de {{publication.Profile.lastName}} {{publication.Profile.firstName}}" />
      </div>
      <div *ngIf="connected" class="action">
        <span *ngIf="!existingVote(publication.Vote)" (click)="like(publication.id)">Jaime ({{countVote(publication.Vote)}})</span>
        <span *ngIf="existingVote(publication.Vote)" (click)="dislike(publication.id)">Jaime plus ({{countVote(publication.Vote)}})</span>
        <span>Commenter</span>
      </div>
      <div class="comments">
        <div class="show-more">Afficher les commentaires précédents</div>
        <div *ngFor="let comment of publication.Comment" class="comment">
          <div class="profile-picture" [style.background-image]="'url(' + getUrlPicture(comment.User.Profile.picture) + ')'"></div>
          <div class="content">
            <span class="name">{{comment.User.Profile.lastName}} {{comment.User.Profile.firstName}}</span>
            <div class="message">{{comment.content}}</div>
          </div>
        </div>
        <form *ngIf="connected" (ngSubmit)="onSubmitComment(f)" #f="ngForm">
          <input type="hidden" id="publicationId" name="publicationId" [ngModel]="publication.id" />
          <input type="text" name="comment" id="comment" placeholder="Écrivez un commentaire..." ngModel />
        </form>
      </div>
    </div>
  </div>

</div>
